<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta http-equiv="X-UA-Compatible" content="IE=9"/>
    <title>EditorTest1</title>
</head>
<body>
<div class="paragraph-content">
    <textarea name="aaa" id="aaa">
        <s>fsafasf</s>
    </textarea>
</div>

<script src="../ckeditor/ckeditor.js"></script>
<script>
    //    var addPage = new AddPage($('.common-page'));
    var editor = CKEDITOR.replace('aaa', {
        language: 'zh-cn',
        toolbar: 'Editor',
        extraPlugins: 'selftag',
        toolbar_Editor: [
            {name: 'styles', items: ['Format']},
            {name: 'basicstyles', items: ['Bold', 'Italic', 'RemoveFormat']},
            {name: 'align', items: ['JustifyLeft', 'JustifyCenter', 'JustifyRight']},
            {name: 'links', items: ['SimpleLink']},
            {name: 'paragraph', items: ['NumberedList', 'BulletedList']},
            {name: 'insert', items: ['Image', 'Table']},
            {name: 'myGroup', items: ['define']},
            {name: 'document', items: ['Source']}
        ],
        // config.removePlugins = 'elementspath';

        format_tags: 'h1;h2;h3;h4;h5;p',

        // This is optional, but will let us define multiple different styles for multiple editors using the same CSS file.
        bodyClass: 'document-editor',
        // An array of stylesheets to style the WYSIWYG area.
        // Note: it is recommended to keep your own styles in a separate file in order to make future updates painless.
        contentsCss: ['../css/ckeditor_style.css'],

        allowedContent: true
        // config.allowedContent = true;
        // "a[href,target]"
    });
    function createFakeSelfTag( editor, attributes,type ) {
        var element = editor.document.createElement( 's', {
            attributes: attributes
        } );
        element.appendText('fuck');
        return editor.createFakeElement(element, 'tag_define', 'tag' + type );
    }
    editor.on('fuck',function (e) {
        var data = e.data;
        var editor = e.editor;
        var insertText = prompt('输入想要的文本');
        if(insertText) {
            var attributes = {
                'data-obj': JSON.stringify({
                    type: 'define',
                    value: 'id1,id2'
                })
            };
            var selection = editor.getSelection();
            var ranges = selection.getRanges();
            var range = ranges[0];

            ranges[0].collapse(true);
            selection.selectRanges(ranges);
//            debugger;

            editor.insertElement(createFakeSelfTag(editor,attributes,'define'));
        }

    });
</script>
<script>

    /*
    * 节 h1
    * 条 h2
    * 款 h3
    * 项 h4
    * 目 h5
    * 普通 p
    * */
    //    config.format_h1={element:"h1", name: "节"};
    //    config.format_h2={element:"h2", name: "条"};
    //    config.format_h3={element:"h3", name: "款"};
    //    config.format_h4={element:"h4", name: "项"};
    //    config.format_h5={element:"h5", name: "目"};
    //    config.format_p={element:"p", name: "普通"};
</script>
</body>
</html>
